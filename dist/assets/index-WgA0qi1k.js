const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/components-BLPTdgF7.js","assets/react-vendor-bLzc_oLC.js","vendor/vendor-3eaMKIIC.js","assets/utils-CamzHhaU.js"])))=>i.map(i=>d[i]);
import{j as e,r as t,R as r,u as a}from"./react-vendor-bLzc_oLC.js";import{E as s,O as n,u as o,M as l,S as i,X as c,a as d,U as u,C as m,P as h,b as x,c as f,d as g,I as v}from"./components-BLPTdgF7.js";import{a as p}from"./utils-CamzHhaU.js";import"../vendor/vendor-3eaMKIIC.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const r of e)if("childList"===r.type)for(const e of r.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const b={},j=function(e,t,r){let a=Promise.resolve();if(t&&t.length>0){let e=function(e){return Promise.all(e.map(e=>Promise.resolve(e).then(e=>({status:"fulfilled",value:e}),e=>({status:"rejected",reason:e}))))};document.getElementsByTagName("link");const r=document.querySelector("meta[property=csp-nonce]"),s=r?.nonce||r?.getAttribute("nonce");a=e(t.map(e=>{if((e=function(e){return"/"+e}(e))in b)return;b[e]=!0;const t=e.endsWith(".css"),r=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${r}`))return;const a=document.createElement("link");return a.rel=t?"stylesheet":"modulepreload",t||(a.as="script"),a.crossOrigin="",a.href=e,s&&a.setAttribute("nonce",s),document.head.appendChild(a),t?new Promise((t,r)=>{a.addEventListener("load",t),a.addEventListener("error",()=>r(new Error(`Unable to preload CSS for ${e}`)))}):void 0}))}function s(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return a.then(t=>{for(const e of t||[])"rejected"===e.status&&s(e.reason);return e().catch(s)})};var y=(e=>(e[e.UPLOAD=0]="UPLOAD",e[e.CROP=1]="CROP",e[e.PRINT=2]="PRINT",e))(y||{});const P=t.lazy(()=>j(()=>import("./components-BLPTdgF7.js").then(e=>e.e),__vite__mapDeps([0,1,2,3]))),w=t.lazy(()=>j(()=>import("./components-BLPTdgF7.js").then(e=>e.f),__vite__mapDeps([0,1,2,3]))),N=()=>e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"spinner"})}),k=()=>{navigator.vibrate&&navigator.vibrate(10)},R=()=>{const{isStorageReady:r,saveProcessedImage:a}=o();t.useEffect(()=>()=>{},[]);const[n,b]=t.useState(y.UPLOAD),[j,R]=t.useState(y.UPLOAD),[O,C]=t.useState(""),[S,L]=t.useState(null),[E,T]=t.useState([]),[D,I]=t.useState([]),[U,A]=t.useState(0),[_,z]=t.useState("light"),[M,$]=t.useState(null),[q,B]=t.useState(!1),W=t.useRef(0),X=t.useRef(0),V=t.useRef(0),Y=t.useRef(0),G=t.useRef(0);t.useRef(!1),t.useEffect(()=>{const e=document.documentElement.classList.contains("dark");z(e?"dark":"light")},[]);const K=t.useCallback(e=>{if(e===n)return;k();const t=e>n?"left":"right";C(`slide-out-${t}`),R(n),b(e),setTimeout(()=>{C(`slide-in-${t}`)},200)},[n]),F=t.useCallback(()=>{T([]),I([]),A(0),L(null),$(null),K(y.UPLOAD)},[K]);t.useEffect(()=>{n!==y.CROP||S||(T([]),I([]),A(0),L(null),$(null),b(y.UPLOAD)),n===y.PRINT&&0===E.length&&(T([]),I([]),A(0),L(null),$(null),b(y.UPLOAD))},[n,S,E.length]);const H=t.useCallback(async e=>{if(0===e.length)return;const t=e.map(async e=>{try{return await p(e,2e3,2e3)}catch(t){return e}}),r=await Promise.all(t),a=r[0],s=r.slice(1);I(s),A(e=>e+r.length),L(a),K(y.CROP)},[K]),J=t.useCallback(async(e,t,s,n="print")=>{const o={id:Date.now().toString(),dataUrl:e,size:t,width_px:s?.width,height_px:s?.height,rotation:0};if(T(e=>(0===e.length&&("Random Size"===t.name?$({mode:"random"}):$({mode:"standard",size:t})),[...e,o])),r)try{await a({id:o.id,dataUrl:o.dataUrl,size:o.size,timestamp:Date.now(),metadata:{pixelDimensions:s,rotation:0}})}catch(l){}if(D.length>0){const e=D[0];I(e=>e.slice(1)),L(e),K(y.CROP)}else K("print"===n?y.PRINT:y.UPLOAD),L(null),A(0)},[D,K,r,a]);t.useEffect(()=>{0===D.length&&n===y.CROP&&null===S&&K(y.PRINT)},[D,n,S,K]);const Q=t.useCallback(e=>{n!==e&&(e===y.UPLOAD?F():e===y.PRINT&&E.length>0&&K(y.PRINT))},[n,E,F,K]),Z=()=>{const e="light"===_?"dark":"light";z(e),localStorage.setItem("theme",e),"dark"===e?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark"),k()},ee=({icon:t,label:r,step:a,currentStep:s,badgeCount:n,onClick:o})=>{const l=a===s,i=s>a;return e.jsxs("button",{onClick:o,className:`relative flex flex-col items-center justify-center transition-all duration-300 group focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-offset-[var(--card-bg)] focus-visible:ring-[var(--accent-primary)] rounded-xl p-2 sm:p-3 min-h-touch min-w-touch touch-target active:scale-95 ${o?"":"cursor-default"} ${l?"bg-[var(--accent-primary-light)]":""}`,"aria-label":`Go to ${r} step`,children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"transition-all duration-300 transform "+(l?"text-[var(--accent-primary)] scale-110":i?"text-[var(--accent-secondary)]":"text-[var(--text-tertiary)] group-hover:text-[var(--text-secondary)]"),children:t}),n&&n>0?e.jsx("span",{className:"absolute -top-1 -right-1 sm:-top-2 sm:-right-2 bg-gradient-to-br from-[var(--accent-primary)] to-[var(--accent-secondary)] text-white text-xs font-bold rounded-full h-4 w-4 sm:h-5 sm:w-5 flex items-center justify-center border-2 border-[var(--card-bg)] shadow-md animate-pulse text-[10px] sm:text-xs",children:n}):null]}),e.jsx("span",{className:"text-xs sm:text-xs font-semibold mt-1 transition-all duration-300 "+(l?"text-[var(--accent-primary)]":i?"text-[var(--accent-secondary)]":"text-[var(--text-tertiary)] group-hover:text-[var(--text-secondary)]"),children:r}),l&&e.jsx("div",{className:"absolute -bottom-1 left-1/2 transform -translate-x-1/2 w-6 h-1 sm:w-8 sm:h-1 bg-[var(--accent-primary)] rounded-full"})]})};return e.jsxs("div",{className:"min-h-screen h-screen flex flex-col overflow-hidden",style:{background:"var(--background-gradient)"},children:[e.jsxs("header",{className:"fixed top-0 left-0 right-0 h-16 px-3 sm:px-4 md:px-6 bg-[var(--card-bg)] backdrop-blur-lg border-b border-[var(--card-border)] z-30 flex items-center justify-between animate-fade-in shadow-sm",style:{paddingTop:"env(safe-area-inset-top)"},children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 min-w-0 flex-1",children:[e.jsxs("div",{className:"relative flex-shrink-0",children:[e.jsx("img",{src:"/favicon.svg",alt:"Image to Print Pro Logo",className:"w-8 h-8 sm:w-10 sm:h-10 rounded-xl shadow-md transition-transform duration-300 hover:scale-110 hover:rotate-6"}),e.jsx("div",{className:"absolute -inset-1 bg-gradient-to-r from-[var(--accent-primary)] to-[var(--accent-secondary)] rounded-xl opacity-20 blur-sm -z-10"})]}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h1",{className:"text-base sm:text-lg md:text-xl font-bold text-[var(--text-primary)] tracking-tight truncate",children:"Image to Print"}),e.jsx("p",{className:"hidden md:block text-xs text-[var(--text-tertiary)] font-medium",children:"Pro Editor"})]})]}),e.jsx("div",{className:"hidden md:flex items-center gap-2",children:e.jsx("button",{onClick:Z,className:"p-2.5 rounded-full bg-[var(--control-bg)] hover:bg-[var(--control-bg-hover)] transition-all duration-300 focus:outline-none focus-visible:ring-2 focus-visible:ring-[var(--accent-primary)] focus-visible:ring-offset-2 elevate","aria-label":`Switch to ${"light"===_?"dark":"light"} mode`,children:e.jsxs("div",{className:"relative w-6 h-6",children:[e.jsx(l,{className:"w-6 h-6 text-[var(--text-secondary)] absolute inset-0 transition-all duration-500 "+("light"===_?"opacity-100 rotate-0 scale-100":"opacity-0 -rotate-180 scale-0")}),e.jsx(i,{className:"w-6 h-6 text-[var(--text-secondary)] absolute inset-0 transition-all duration-500 "+("dark"===_?"opacity-100 rotate-0 scale-100":"opacity-0 rotate-180 scale-0")})]})})}),e.jsx("button",{onClick:()=>B(!q),className:"md:hidden p-2 rounded-lg bg-[var(--control-bg)] hover:bg-[var(--control-bg-hover)] transition-all duration-300 min-h-touch min-w-touch touch-target","aria-label":"Toggle menu","aria-expanded":q,children:q?e.jsx(c,{className:"w-6 h-6 text-[var(--text-secondary)]"}):e.jsx(d,{className:"w-6 h-6 text-[var(--text-secondary)]"})}),q&&e.jsx("div",{className:"md:hidden fixed inset-0 z-40 bg-black/50 backdrop-blur-sm",onClick:()=>B(!1),children:e.jsx("div",{className:"fixed top-16 right-0 w-full max-w-xs bg-[var(--card-bg)] border-l border-[var(--card-border)] shadow-xl animate-slide-up",children:e.jsx("div",{className:"p-4 space-y-3",children:e.jsxs("button",{onClick:()=>{Z(),B(!1)},className:"w-full flex items-center gap-3 p-3 rounded-lg bg-[var(--control-bg)] hover:bg-[var(--control-bg-hover)] transition-all duration-300 text-left",children:[e.jsxs("div",{className:"relative w-6 h-6",children:[e.jsx(l,{className:"w-6 h-6 text-[var(--text-secondary)] absolute inset-0 transition-all duration-500 "+("light"===_?"opacity-100 rotate-0 scale-100":"opacity-0 -rotate-180 scale-0")}),e.jsx(i,{className:"w-6 h-6 text-[var(--text-secondary)] absolute inset-0 transition-all duration-500 "+("dark"===_?"opacity-100 rotate-0 scale-100":"opacity-0 rotate-180 scale-0")})]}),e.jsx("span",{className:"text-[var(--text-primary)] font-medium",children:"light"===_?"Dark Mode":"Light Mode"})]})})})})]}),e.jsx("main",{className:"flex-grow pt-16 w-full overflow-y-auto overflow-x-hidden",onTouchStart:e=>{if(e.targetTouches.length>1)return;const t=e.targetTouches[0];W.current=t.clientX,X.current=t.clientY,G.current=Date.now(),e.preventDefault()},onTouchMove:e=>{if(e.targetTouches.length>1)return;const t=e.targetTouches[0];V.current=t.clientX,Y.current=t.clientY;const r=Math.abs(V.current-W.current);r>Math.abs(Y.current-X.current)&&r>10&&e.preventDefault()},onTouchEnd:e=>{const t=Date.now()-G.current,r=Math.abs(V.current-W.current),a=Math.abs(Y.current-X.current);r>=50&&r>a&&t<=300&&(W.current-V.current>50&&(n===y.CROP&&E.length>0&&K(y.PRINT),n===y.UPLOAD&&S&&K(y.CROP)),V.current-W.current>50&&(n===y.CROP&&Q(y.UPLOAD),n===y.PRINT&&K(y.CROP))),W.current=0,X.current=0,V.current=0,Y.current=0,G.current=0},children:e.jsx("div",{className:`w-full min-h-full p-3 sm:p-4 md:p-6 pb-20 sm:pb-24 md:pb-28 transition-all duration-300 ${O}`,children:(r=>{switch(r){case y.UPLOAD:return e.jsx(v,{onImagesUpload:H});case y.CROP:if(S){const r=U-D.length;return e.jsx(s,{children:e.jsx(t.Suspense,{fallback:e.jsx(N,{}),children:e.jsx(P,{imageSrc:S,onProcess:J,onBack:F,queuePosition:r>0?r:void 0,queueLength:U>1?U:void 0,sheetMode:M},S)})})}return null;case y.PRINT:return E.length>0?e.jsx(s,{children:e.jsx(t.Suspense,{fallback:e.jsx(N,{}),children:e.jsx(w,{images:E,setImages:T,onReset:F,onBack:()=>K(y.CROP)})})}):null;default:return null}})(n)})}),e.jsx("nav",{className:"fixed bottom-0 left-0 right-0 h-16 sm:h-20 bg-[var(--card-bg)] backdrop-blur-lg border-t border-[var(--card-border)] z-30 shadow-lg",style:{paddingBottom:"env(safe-area-inset-bottom)"},children:e.jsxs("div",{className:"max-w-md mx-auto h-full flex justify-around items-center px-2 sm:px-4",children:[e.jsx(ee,{icon:e.jsx(u,{}),label:"Upload",step:y.UPLOAD,currentStep:n,onClick:()=>Q(y.UPLOAD)}),e.jsx(ee,{icon:e.jsx(m,{}),label:"Edit",step:y.CROP,currentStep:n}),e.jsx(ee,{icon:e.jsx(h,{}),label:"Print",step:y.PRINT,currentStep:n,onClick:()=>Q(y.PRINT),badgeCount:E.length})]})}),e.jsx(x,{}),e.jsx(f,{}),e.jsx(g,{})]})},O=()=>e.jsx(s,{children:e.jsx(n,{children:e.jsx(R,{})})}),C=document.getElementById("root");if(!C)throw new Error("Could not find root element to mount to");r.createRoot(C).render(e.jsx(a.StrictMode,{children:e.jsx(O,{})})),"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/sw.js").then(e=>{}).catch(e=>{})});
